<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">
        <meta name="author" content="">

        <title>Volunteer profile</title>

        <!-- Bootstrap core CSS -->
        <link href="css/bootstrap.css" rel="stylesheet">
        <link href="http://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
        <!-- Add custom CSS here -->
        <link href="css/simple-sidebar.css" rel="stylesheet">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js"></script>        
    </head>


    <body>

        <div id="wrapper">

            <!-- Sidebar -->
            <div id="sidebar-wrapper">
                <ul class="sidebar-nav">

                    <li class="sidebar-brand"><a href="#">Name</a>
                    </li>
                    <li ><img src="images/profileblank.png" width="50px;"></li>
                    <hr>
                    <li><a href="profile.html">Profile</a>
                    </li>
                    <li><a href="#">Schedule</a>
                    </li>
                    <li><a href="#">Requests</a>
                    </li>
                    <hr>
                </ul>
            </div>

            <!-- Page content -->
            <div id="page-content-wrapper">
                <div class="content-header">
                    <a id="menu-toggle" href="#" ><i class="fa fa-2x fa-bars"></i></a>
                    <h1 class="wht" id="profname">
                        Name profile
                    </h1>
                </div>
                <!-- Keep all page content within the page-content inset div! -->
                <div class="page-content inset">
                    <div class="row">
                        <div class="col-md-12">
                            <p class="email" id="email">email@email.com</p>
                        </div>
                        <div class="col-md-12 profaddress well">
                            <p class="faded heading">My address | <a hre="">Edit</a></p>
                            <p class="address" id="line1">Block 73 Telok Blangah Heights</p>
                            <p class="address" id="line2"></p>
                            <p class="address" id="city">Singapore</p>
                            <p class="address" id="postcode">100073</p>
                        </div>
                        <h4 class="wht">My schedule</h4>
                        <div id="schedule-cards"></div>
                        <div class="col-mg-12 schedule well" id="schedule1">
                            <div class="schedule-condensed">
                                <div class="spl">Bakery</div>
                                <div>to</div>
                                <div class="spl">Home</div>
                                <div>at</div>
                                <div class="spl">11:20 PM</div>
                                <div>on</div>
                                <div class="spl">7-Jun-2014</div>
                                <a href="#" class="map-btn btn btn-primary" id="map-btn">Map</a>
                            </div>    

                            <!-- expanded card -->
                            <div class="schedule-expanded" style="margin-top:20px;">
                                <div class="pickupaddress">
                                    <p>21 Lower Kent Ridge Road<br>
                                        Singapore 119077</p>
                                </div>
                                <div class="delivertosymbol"><i class="fa fa-lg fa-long-arrow-right" style="margin-top: 0;"></i></div>
                                <div class="deliveraddress">
                                    <p>154 West Coast Road<br>
                                        Singapore 127371</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-mg-12 schedule well" id="schedule2">
                            <div class="schedule-condensed">
                                <div class="spl">Bakery</div>
                                <div>to</div>
                                <div class="spl">Home</div>
                                <div>at</div>
                                <div class="spl">11:20 PM</div>
                                <div>on</div>
                                <div class="spl">7-Jun-2014</div>
                                <a href="#" class="btn btn-primary map-btn">Map</a>
                            </div>    

                            <!-- expanded card -->
                            <div class="schedule-expanded" style="margin-top:20px;">
                                <div class="pickupaddress">
                                    <p>Blk 23 Ang Mo Kio<br>
                                        Street 100<br>
                                        Singapore 132892</p>
                                </div>
                                <div class="delivertosymbol"><i class="fa fa-lg fa-long-arrow-right" style="margin-top: 0;"></i></div>
                                <div class="deliveraddress">
                                    <p>Blk 23 Ang Mo Kio<br>
                                        Street 100<br>
                                        Singapore 196278</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-mg-12 schedule well" id="schedule3">
                            <div class="schedule-condensed">
                                <div class="spl">Bakery</div>
                                <div>to</div>
                                <div class="spl">Home</div>
                                <div>at</div>
                                <div class="spl">11:20 PM</div>
                                <div>on</div>
                                <div class="spl">7-Jun-2014</div>
                                <a href="#" class="btn btn-primary map-btn">Map</a>
                            </div>    

                            <!-- expanded card -->
                            <div class="schedule-expanded" style="margin-top:20px;">
                                <div class="pickupaddress">
                                    <p>Blk 23 Ang Mo Kio<br>
                                        Street 100<br>
                                        Singapore 132892</p>
                                </div>
                                <div class="delivertosymbol"><i class="fa fa-lg fa-long-arrow-right" style="margin-top: 0;"></i></div>
                                <div class="deliveraddress">
                                    <p>Blk 23 Ang Mo Kio<br>
                                        Street 100<br>
                                        Singapore 196278</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-mg-12 schedule well" id="schedule4">
                            <div class="schedule-condensed">
                                <div class="spl">Bakery</div>
                                <div>to</div>
                                <div class="spl">Home</div>
                                <div>at</div>
                                <div class="spl">11:20 PM</div>
                                <div>on</div>
                                <div class="spl">7-Jun-2014</div>
                                <a href="#" class="btn btn-primary map-btn">Map</a>
                            </div>    

                            <!-- expanded card -->
                            <div class="schedule-expanded" style="margin-top:20px;">
                                <div class="pickupaddress">
                                    <p>Blk 23 Ang Mo Kio<br>
                                        Street 100<br>
                                        Singapore 132892</p>
                                </div>
                                <div class="delivertosymbol"><i class="fa fa-lg fa-long-arrow-right" style="margin-top: 0;"></i></div>
                                <div class="deliveraddress">
                                    <p>Blk 23 Ang Mo Kio<br>
                                        Street 100<br>
                                        Singapore 196278</p>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>
            </div>
        </div>

    </div>

    <script>
        function removeExtras( str)
        {
            str = str.replace('<p>','');
            str = str.replace('</p>', '');
            str = str.replace(/<br>/g, ' ');
            str = str.replace(/\t/g, '');
            str = str.replace(/\n/g, '');
            str = str.replace(/\s+/g, ' ');
            return str;
        }

        $('.map-btn').click(function(){
            var prnt = $(this).parentsUntil("schedule");

            var locationAddress = document.getElementById("line1").innerHTML + document.getElementById("line2").innerHTML + ' ' + document.getElementById("city").innerHTML + ' ' + document.getElementById("postcode").innerHTML;
            var pickAddress = prnt[1].children[1].children[0].innerHTML;
            var deliverAddress = prnt[1].children[1].children[2].innerHTML;

            pickAddress = removeExtras(pickAddress);
            deliverAddress = removeExtras(deliverAddress);

            console.log(pickAddress);
            console.log(deliverAddress);

            var obj = {pick: pickAddress, deliver: deliverAddress, start: locationAddress};
            window.location.href = "route.html?"+$.param(obj, true);
        });

    </script>

    <!-- Custom JavaScript for the Menu Toggle -->
    <script src="js/jquery-1.10.2.js"></script>
    <script src="js/bootstrap.js"></script>

    <!-- Custom JavaScript for the Menu Toggle -->
    <script>
        $("#menu-toggle").click(function(e) {
            e.preventDefault();
            $("#wrapper").toggleClass("active");
        });
        $(document).ready(function()
        {
        $.ajax({
            dataType: "jsonp",
            url: "http://ffh.cloudapp.net/users",
            success: function(data){
                
                var user="5392cfb4c0d72df2680dd74d";
                
                var userFound = 0;
                for(var i=0; i<data.length; ++i)
                {
                    if(data[i]._id == user)
                    {
                        userFound =1;
                        
                        document.getElementById("profname").innerHTML = data[i].name;
                        document.getElementById("email").innerHTML = data[i].email;
                        
                        for(var j=0; j<data[i].routes.length; ++j)
                        {
                            var scheduleDiv = document.createElement('div');
                            scheduleDiv
                        }
                    }
                    
                }
                
                if (userFound == 0)
                {
                    alert("No user found");
                }
            
            }
        });
            });
    </script>
    <script>
        
    </script>

</body>

</html>
